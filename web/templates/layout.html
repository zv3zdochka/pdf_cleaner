<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{{ title or "PDF Cleaner Web" }}</title>
  <link rel="stylesheet" href="/static/styles.css" />
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="brand">
        <h1>PDF Cleaner</h1>
        <div class="sub">Web UI для просмотра/скачивания/удаления сохранённых файлов</div>
      </div>
      <div class="kpis">
        <div class="kpi">
          <div class="label">Storage</div>
          <div class="value mono">{{ used_h }} / {{ limit_h }}</div>
        </div>
        <div class="kpi">
          <div class="label">Requests</div>
          <div class="value mono">{{ total_requests }}</div>
        </div>
        <div class="kpi">
          <div class="label">Users</div>
          <div class="value mono">{{ total_users }}</div>
        </div>
      </div>
    </div>

    {% block body %}{% endblock %}

    <div class="footer">
      Советы: не публикуй вебку в интернет без HTTPS и ограничений доступа. Используй Basic Auth и, по возможности, VPN.
    </div>
  </div>

<script>
async function deleteRequest(userId, requestId){
  const ok = confirm("Удалить этот запрос и ВСЕ его файлы насовсем?");
  if(!ok) return;
  const resp = await fetch(`/api/users/${userId}/requests/${requestId}`, {
    method: "DELETE",
    headers: {"Content-Type":"application/json"}
  });
  if(resp.ok){
    window.location.href = "/";
  } else {
    const t = await resp.text();
    alert("Ошибка удаления: " + t);
  }
}
</script>
</body>
</html>
